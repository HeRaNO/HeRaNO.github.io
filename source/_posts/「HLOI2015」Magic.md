---
title: 「HLOI2015」Magic
date: 2016-04-30 21:33:32
categories: "OI/ICPC"
tags:
	- HLOI
	- 最小生成树
	- 最短路
toc: true
description: HLOI2015 Day1 T1
---

//这次貌似暴露省份了……

## 题目描述
Chavo 是一个生活在魔法世界里的小法师。魔法的世界里有 $n$ 座法师塔，第 $i$ 座法师塔有 $a_i$ 点魔法。其中有 $m$ 对法师塔之间可以相互传送，传送消耗的魔法值是两个法师塔魔法值的最小公倍数。

Chavo 想要从第一座法师塔传送到第 $n$ 座法师塔，她在每一次传送之后都会等待魔法全部恢复再进行下一次传送，也就是说 Chavo 需要的魔法值只是所有传送消耗魔法的最大值。

Chavo 想知道她最少需要多少魔法值就可以从第一座法师塔传送到第 $n$ 座法师塔？

## 输入
第一行输入整数 $n$ 和 $m$。

接下来一行 $n$ 个数，第 $i$ 个数 $a_i$ 代表第 $i$ 座法师塔的魔法值。

接下来 $m$ 行，每行 $2$ 个数 $u,v$，代表第 $u$ 座法师塔和第 $v$ 座法师塔之间可以相互传送。

## 输出
输出一行带有一个整数，代表需要的最小魔法值。

## 样例输入
```
3 3
2 3 5
1 3
3 1
2 2
```

## 样例输出
```
10
```

## 样例说明
只有一条路径从 $1$ 到 $3$，传送需要的魔法值是 $2$ 和 $5$ 的最小公倍数 $10$，故需要 $10$ 点魔法值。

## 数据范围及约定
对于 $30\%$ 的数据，$1\le n,m\le 100,1\le u,v\le n,1\le a_i\le 10^3$；

对于 $60\%$ 的数据，$1\le n\le 100,1\le m\le 10^4,1\le u,v\le n,1\le a_i\le 10^3$；

对于 $100\%$ 的数据，$1\le n,m\le 10^5,1\le u,v\le n,1\le a_i\le 10^3$。

## 时间限制与空间限制
时间限制：$2000\text{ms}$，空间限制：$128\text{MB}$。

## 题解
因为最大值符合加法性质（即两部分最大值的最大值为整体最大值），所以可以类似 SPFA 一样松弛。

~~应该是这样吧，题解打的是二分套 SPFA 验证。~~

根据题目，求的是两点之间的路径长度最大值的最小值，考虑货车运输的类似做法即可，不过货车运输求的是两点之间路径长度最小值的最大值。

直接 SPFA 的时间复杂度是 $\mathcal{O}(km)$ 的，标程的时间复杂度是 $\mathcal{O}(km\log L)$ 的，最小生成树的时间复杂度是 $\mathcal{O}(m\log m+m\alpha(n))$ 的。

代码见[这里](https://github.com/HeRaNO/OI-ICPC-Codes/blob/master/HSAHRBNUOJ/P20xx/P2073.cpp)。
